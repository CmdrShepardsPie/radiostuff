{"version":3,"file":"make-yaesu.js","sourceRoot":"","sources":["../../src/scripts/make-yaesu.ts"],"names":[],"mappings":"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","sourcesContent":["import 'module-alias/register';\n\nimport { readFileAsync, writeToJsonAndCsv } from '@helpers/fs-helpers';\nimport { createLog } from '@helpers/log-helpers';\nimport { IRepeaterStructured, RepeaterStatus, RepeaterUse } from '@interfaces/i-repeater-structured';\nimport { ISimplexFrequency } from '@interfaces/i-simplex-frequency';\nimport { IYaesu, YaesuDirection, YaesuMode, YaesuToneMode } from '@interfaces/i-yaesu';\nimport gpsDistance, { Point } from 'gps-distance';\n\nconst log: (...msg: any[]) => void = createLog('Make Yaesu');\n\nconst yaesu: IYaesu = {\n  Number: null as any,\n  Receive: '',\n  Transmit: '',\n  Offset: (0).toFixed(5),\n  Direction: 'OFF',\n  Mode: 'FM',\n  Name: '',\n  ToneMode: 'OFF',\n  CTCSS: '100 Hz',\n  DCS: '023',\n  UserCTCSS: '1500 Hz',\n  Power: 'HIGH',\n  Skip: 'OFF',\n  Step: '25.0KHz',\n  ClockShift: 0,\n  Comment: '',\n  Bank: 0,\n};\n\nconst myPoint: Point = [39.627071500, -104.893322500]; // 4982 S Ulster St\n\nasync function doIt(inFileName: string, outFileName: string): Promise<void> {\n  const simplex: IRepeaterStructured[] =\n    JSON.parse((await readFileAsync('data/frequencies.json')).toString())\n      .map((map: ISimplexFrequency) =>\n        ({ Callsign: map.Name, Frequency: { Output: map.Frequency, Input: map.Frequency } }))\n      .filter((filter: IRepeaterStructured) => /FM|Voice|Simplex/i.test(filter.Callsign));\n  // .filter((filter: IRepeaterStructured) => !(/Data|Digital|Packet/i.test(filter.Callsign)));\n\n  const repeaters: IRepeaterStructured[] =\n    JSON.parse((await readFileAsync(inFileName)).toString());\n\n  repeaters.forEach((each: IRepeaterStructured) => {\n    each.Location.Distance = gpsDistance([myPoint, [each.Location.Latitude, each.Location.Longitude]]);\n  });\n\n  repeaters.sort((a: IRepeaterStructured, b: IRepeaterStructured) =>\n    a.Location.Distance! > b.Location.Distance! ? 1 :\n      a.Location.Distance! < b.Location.Distance! ? -1 : 0);\n  const mapped: IYaesu[] = [\n    ...simplex,\n    ...repeaters\n      .filter((filter: IRepeaterStructured) =>\n        (filter.Frequency.Output >= 144 && filter.Frequency.Output <= 148) ||\n        // (filter.Frequency.Output >= 222 && filter.Frequency.Output <= 225) ||\n        (filter.Frequency.Output >= 420 && filter.Frequency.Output <= 450))\n      .filter((filter: IRepeaterStructured) =>\n        (!filter.Digital || filter.Digital.YSF) &&\n        filter.Status !== RepeaterStatus.OffAir &&\n        filter.Use === RepeaterUse.Open),\n  ]\n    .map((map: IRepeaterStructured, index: number): IYaesu => ({ ...convertToRadio(map), Number: index + 1 }))\n    .slice(0, 500)\n    .sort((a: IYaesu, b: IYaesu) => parseFloat(a.Receive) - parseFloat(b.Receive))\n    .map((map: IYaesu, index: number): IYaesu => ({ ...map, Number: index + 1 }));\n\n  return writeToJsonAndCsv(outFileName, mapped);\n}\n\nfunction convertToRadio(repeater: IRepeaterStructured): IYaesu {\n  let Name: string = '';\n\n  if (repeater.Callsign) {\n    Name += repeater.Callsign.trim();\n    if (repeater.ID !== undefined) {\n      Name = Name.substr(-3).trim().toUpperCase();\n    }\n  }\n\n  if (repeater.Location && repeater.Location.Local) {\n    Name += (Name ? ' ' : '') + repeater.Location.Local.trim().toLowerCase();\n  }\n\n  if (repeater.Frequency && repeater.Frequency.Output) {\n    Name += (Name ? ' ' : '') + repeater.Frequency.Output.toString().trim();\n  }\n\n  Name = Name.replace(/[^0-9.a-zA-Z\\/]/g, '').trim();\n  Name = Name.substring(0, 7).trim();\n\n  const Receive: string = repeater.Frequency.Output.toFixed(5);\n  const Transmit: string = repeater.Frequency.Input.toFixed(5);\n  const OffsetNumber: number = repeater.Frequency.Input - repeater.Frequency.Output;\n  const Direction: YaesuDirection = OffsetNumber > 0 ? '+RPT' : OffsetNumber < 0 ? '-RPT' : 'OFF';\n  const Offset: string = Math.abs(Math.round(OffsetNumber * 100) / 100).toFixed(5);\n  const TransmitSquelchTone: number | undefined = (repeater.SquelchTone && repeater.SquelchTone.Input);\n  const ReceiveSquelchTone: number | undefined = (repeater.SquelchTone && repeater.SquelchTone.Output);\n  const TransmitDigitalTone: number | undefined = (repeater.DigitalTone && repeater.DigitalTone.Input);\n  const ReceiveDigitalTone: number | undefined = (repeater.DigitalTone && repeater.DigitalTone.Output);\n  let ToneMode: YaesuToneMode = 'OFF';\n  const Mode: YaesuMode = 'FM';\n  let Comment: string = `${repeater.StateID} ${repeater.ID} ${repeater.Location && repeater.Location.Distance && repeater.Location.Distance.toFixed(2)} ${repeater.Location && repeater.Location.State} ${repeater.Location && repeater.Location.County} ${repeater.Location && repeater.Location.Local} ${repeater.Callsign}`;\n  Comment = Comment.replace(/undefined/g, ' ').replace(/\\s+/g, ' ').trim();\n\n  if (TransmitSquelchTone) {\n    ToneMode = 'TONE ENC';\n  } else if (TransmitDigitalTone) {\n    ToneMode = 'DCS';\n  }\n\n  if (TransmitSquelchTone && ReceiveSquelchTone && TransmitSquelchTone === ReceiveSquelchTone) {\n    ToneMode = 'TONE SQL';\n  } else if (TransmitDigitalTone && ReceiveDigitalTone && TransmitDigitalTone === ReceiveDigitalTone) {\n    ToneMode = 'DCS';\n  }\n\n  const CTCSS: string = (TransmitSquelchTone || 100).toFixed(1) + ' Hz';\n  const DCSNumber: number = (TransmitDigitalTone || 23);\n  const DCS: string = DCSNumber < 100 ? '0' + DCSNumber : '' + DCSNumber;\n\n  return {\n    ...yaesu,\n    Receive,\n    Transmit,\n    Offset,\n    Direction,\n    Name,\n    ToneMode,\n    CTCSS,\n    DCS,\n    Mode,\n    Comment,\n  };\n}\n\nasync function start(): Promise<void> {\n// const coFiles = (await readdirAsync(\"./repeaters/data/CO/\")).map((f) => `data/CO/${f}`);\n// const utFiles = (await readdirAsync(\"./repeaters/data/UT/\")).map((f) => `data/UT/${f}`);\n// const nmFiles = (await readdirAsync(\"./repeaters/data/NM/\")).map((f) => `data/NM/${f}`);\n// const coGroups = (await readdirAsync(\"./repeaters/groups/CO/\")).map((f) => `groups/CO/${f}`);\n// const utGroups = (await readdirAsync(\"./repeaters/groups/UT/\")).map((f) => `groups/UT/${f}`);\n// const nmGroups = (await readdirAsync(\"./repeaters/groups/NM/\")).map((f) => `groups/NM/${f}`);\n// const allFiles = [...coFiles, ...utFiles, ...nmFiles, ...coGroups, ...utGroups, ...nmGroups].filter((f) => /\\.json$/.test(f)).map((f) => f.replace(\".json\", \"\"));\n// for (const file of allFiles) {\n//   await doIt(file);\n// }\n\n// await doIt(\"data/repeaters/groups/CO/Colorado Springs - Call.json\", \"data/repeaters/yaesu/groups/CO/Colorado Springs - Call\");\n// await doIt(\"data/repeaters/results/CO/Colorado Springs.json\", \"data/repeaters/yaesu/CO/Colorado Springs\");\n  await doIt('data/repeaters/converted/CO.json', 'data/repeaters/yaesu/CO');\n  // await doIt('data/repeaters/groups/combined/CO - Call.json', 'data/repeaters/yaesu/groups/CO - Call');\n}\n\nexport default start();\n"]}