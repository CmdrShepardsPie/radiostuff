"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
require("module-alias/register");
const csv_helpers_1 = require("@helpers/csv-helpers");
const fs_helpers_1 = require("@helpers/fs-helpers");
const helpers_1 = require("@helpers/helpers");
const log_helpers_1 = require("@helpers/log-helpers");
const chalk_1 = __importDefault(require("chalk"));
const scraper_1 = __importDefault(require("./modules/scraper"));
const log = log_helpers_1.createLog("Get Repeaters");
async function save(place, distance) {
    log(chalk_1.default.green("Save"), place, distance);
    const scraper = new scraper_1.default(place, distance);
    const result = await scraper.process();
    // @ts-ignore
    const columns = {};
    result.forEach((row) => {
        Object.entries(row).forEach((entry) => {
            const key = entry[0];
            const value = entry[1];
            if (!columns[key]) {
                columns[key] = [];
            }
            if (columns[key].indexOf(value) === -1) {
                columns[key].push(value);
            }
        });
    });
    result.forEach((row) => {
        Object.entries(row).forEach((entry) => {
            const key = entry[0];
            const value = entry[1];
            if (columns[key].length === 1 && columns[key][0] === "" && value === "") {
                // @ts-ignore
                row[key] = "yes";
            }
        });
    });
    result.sort((a, b) => {
        const aMi = helpers_1.numberToString(a.Mi || 0, 4, 5);
        const bMi = helpers_1.numberToString(b.Mi || 0, 4, 5);
        const aName = a.Call;
        const bName = b.Call;
        const aFrequency = helpers_1.numberToString(a.Frequency || 0, 4, 5);
        const bFrequency = helpers_1.numberToString(b.Frequency || 0, 4, 5);
        const aStr = `${aMi} ${aName} ${aFrequency}`;
        const bStr = `${bMi} ${bName} ${bFrequency}`;
        return aStr > bStr ? 1 : aStr < bStr ? -1 : 0;
    });
    // result.sort((a, b) => {(a.Call > b.Call ? 1 : a.Call < b.Call ? -1 : 0));
    // result.sort((a, b) => (a.Frequency - b.Frequency));
    // result.sort((a, b) => (a.Mi - b.Mi));
    // console.log(place, distance, result.length);
    const parts = place.toString().split(`,`);
    const subPlace = `${(parts[1] || ".").trim()}/${parts[0].trim()}`;
    log(chalk_1.default.yellow("Results"), result.length, subPlace);
    await fs_helpers_1.writeToJsonAndCsv(`../data/repeaters/results/${subPlace}`, result);
}
exports.default = (async () => {
    const countyFileData = await fs_helpers_1.readFileAsync("../data/Colorado_County_Seats.csv");
    const countyData = await csv_helpers_1.parseAsync(countyFileData, { columns: true });
    const cities = countyData.map((c) => `${c["County Seat"]}, CO`);
    while (cities.length) {
        const name = cities.shift();
        if (name) {
            await save(name, 200);
        }
    }
})();
// export default start();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0LXJlcGVhdGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9nZXQtcmVwZWF0ZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsaUNBQStCO0FBRS9CLHNEQUFrRDtBQUNsRCxvREFBdUU7QUFDdkUsOENBQWtEO0FBQ2xELHNEQUFpRDtBQUdqRCxrREFBMEI7QUFDMUIsZ0VBQXdDO0FBRXhDLE1BQU0sR0FBRyxHQUE0Qix1QkFBUyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBRWhFLEtBQUssVUFBVSxJQUFJLENBQUMsS0FBc0IsRUFBRSxRQUFnQjtJQUMxRCxHQUFHLENBQUMsZUFBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFFMUMsTUFBTSxPQUFPLEdBQVksSUFBSSxpQkFBTyxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztJQUV0RCxNQUFNLE1BQU0sR0FBbUIsTUFBTSxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7SUFFdkQsYUFBYTtJQUNiLE1BQU0sT0FBTyxHQUFxRSxFQUFFLENBQUM7SUFDckYsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQWlCLEVBQUUsRUFBRTtRQUNuQyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQThDLEVBQUUsRUFBRTtZQUM3RSxNQUFNLEdBQUcsR0FBdUIsS0FBSyxDQUFDLENBQUMsQ0FBdUIsQ0FBQztZQUMvRCxNQUFNLEtBQUssR0FBZ0MsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3BELElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7Z0JBQ2pCLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7YUFDbkI7WUFDRCxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FB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Q0FBQztJQUN4RixNQUFNLFVBQVUsR0FBa0IsTUFBTSx3QkFBVSxDQUFDLGNBQWMsRUFBRSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ3RGLE1BQU0sTUFBTSxHQUFhLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFjLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN2RixPQUFPLE1BQU0sQ0FBQyxNQUFNLEVBQUU7UUFDcEIsTUFBTSxJQUFJLEdBQXVCLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNoRCxJQUFJLElBQUksRUFBRTtZQUNSLE1BQU0sSUFBSSxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQztTQUN2QjtLQUNGO0FBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUVMLDBCQUEwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcIm1vZHVsZS1hbGlhcy9yZWdpc3RlclwiO1xyXG5cclxuaW1wb3J0IHsgcGFyc2VBc3luYyB9IGZyb20gXCJAaGVscGVycy9jc3YtaGVscGVyc1wiO1xyXG5pbXBvcnQgeyByZWFkRmlsZUFzeW5jLCB3cml0ZVRvSnNvbkFuZENzdiB9IGZyb20gXCJAaGVscGVycy9mcy1oZWxwZXJzXCI7XHJcbmltcG9ydCB7IG51bWJlclRvU3RyaW5nIH0gZnJvbSBcIkBoZWxwZXJzL2hlbHBlcnNcIjtcclxuaW1wb3J0IHsgY3JlYXRlTG9nIH0gZnJvbSBcIkBoZWxwZXJzL2xvZy1oZWxwZXJzXCI7XHJcbmltcG9ydCB7IElDb3VudHlTZWF0IH0gZnJvbSBcIkBpbnRlcmZhY2VzL2ktY291bnR5LXNlYXRcIjtcclxuaW1wb3J0IHsgSVJlcGVhdGVyUmF3IH0gZnJvbSBcIkBpbnRlcmZhY2VzL2ktcmVwZWF0ZXItcmF3XCI7XHJcbmltcG9ydCBjaGFsayBmcm9tIFwiY2hhbGtcIjtcclxuaW1wb3J0IFNjcmFwZXIgZnJvbSBcIi4vbW9kdWxlcy9zY3JhcGVyXCI7XHJcblxyXG5jb25zdCBsb2c6ICguLi5tc2c6IGFueVtdKSA9PiB2b2lkID0gY3JlYXRlTG9nKFwiR2V0IFJlcGVhdGVyc1wiKTtcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHNhdmUocGxhY2U6IHN0cmluZyB8IG51bWJlciwgZGlzdGFuY2U6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gIGxvZyhjaGFsay5ncmVlbihcIlNhdmVcIiksIHBsYWNlLCBkaXN0YW5jZSk7XHJcblxyXG4gIGNvbnN0IHNjcmFwZXI6IFNjcmFwZXIgPSBuZXcgU2NyYXBlcihwbGFjZSwgZGlzdGFuY2UpO1xyXG5cclxuICBjb25zdCByZXN1bHQ6IElSZXBlYXRlclJhd1tdID0gYXdhaXQgc2NyYXBlci5wcm9jZXNzKCk7XHJcblxyXG4gIC8vIEB0cy1pZ25vcmVcclxuICBjb25zdCBjb2x1bW5zOiB7IFtrZXkgaW4ga2V5b2YgSVJlcGVhdGVyUmF3XTogKHN0cmluZyB8IG51bWJlciB8IHVuZGVmaW5lZClbXSB9ID0ge307XHJcbiAgcmVzdWx0LmZvckVhY2goKHJvdzogSVJlcGVhdGVyUmF3KSA9PiB7XHJcbiAgICBPYmplY3QuZW50cmllcyhyb3cpLmZvckVhY2goKGVudHJ5OiBbc3RyaW5nLCAoc3RyaW5nIHwgbnVtYmVyIHwgdW5kZWZpbmVkKV0pID0+IHtcclxuICAgICAgY29uc3Qga2V5OiBrZXlvZiBJUmVwZWF0ZXJSYXcgPSBlbnRyeVswXSBhcyBrZXlvZiBJUmVwZWF0ZXJSYXc7XHJcbiAgICAgIGNvbnN0IHZhbHVlOiBzdHJpbmcgfCBudW1iZXIgfCB1bmRlZmluZWQgPSBlbnRyeVsxXTtcclxuICAgICAgaWYgKCFjb2x1bW5zW2tleV0pIHtcclxuICAgICAgICBjb2x1bW5zW2tleV0gPSBbXTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoY29sdW1uc1trZXldIS5pbmRleE9mKHZhbHVlKSA9PT0gLTEpIHtcclxuICAgICAgICBjb2x1bW5zW2tleV0hLnB1c2godmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgcmVzdWx0LmZvckVhY2goKHJvdzogSVJlcGVhdGVyUmF3KSA9PiB7XHJcbiAgICBPYmplY3QuZW50cmllcyhyb3cpLmZvckVhY2goKGVudHJ5OiBbc3RyaW5nLCAoc3RyaW5nIHwgbnVtYmVyIHwgdW5kZWZpbmVkKV0pID0+IHtcclxuICAgICAgY29uc3Qga2V5OiBrZXlvZiBJUmVwZWF0ZXJSYXcgPSBlbnRyeVswXSBhcyBrZXlvZiBJUmVwZWF0ZXJSYXc7XHJcbiAgICAgIGNvbnN0IHZhbHVlOiBzdHJpbmcgfCBudW1iZXIgfCB1bmRlZmluZWQgPSBlbnRyeVsxXTtcclxuICAgICAgaWYgKGNvbHVtbnNba2V5XSEubGVuZ3RoID09PSAxICYmIGNvbHVtbnNba2V5XSFbMF0gPT09IFwiXCIgJiYgdmFsdWUgPT09IFwiXCIpIHtcclxuICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgcm93W2tleV0gPSBcInllc1wiO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgcmVzdWx0LnNvcnQoKGE6IElSZXBlYXRlclJhdywgYjogSVJlcGVhdGVyUmF3KSA9PiB7XHJcbiAgICBjb25zdCBhTWk6IHN0cmluZyA9IG51bWJlclRvU3RyaW5nKGEuTWkgfHwgMCwgNCwgNSk7XHJcbiAgICBjb25zdCBiTWk6IHN0cmluZyA9IG51bWJlclRvU3RyaW5nKGIuTWkgfHwgMCwgNCwgNSk7XHJcbiAgICBjb25zdCBhTmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkID0gYS5DYWxsO1xyXG4gICAgY29uc3QgYk5hbWU6IHN0cmluZyB8IHVuZGVmaW5lZCA9IGIuQ2FsbDtcclxuICAgIGNvbnN0IGFGcmVxdWVuY3k6IHN0cmluZyA9IG51bWJlclRvU3RyaW5nKGEuRnJlcXVlbmN5IHx8IDAsIDQsIDUpO1xyXG4gICAgY29uc3QgYkZyZXF1ZW5jeTogc3RyaW5nID0gbnVtYmVyVG9TdHJpbmcoYi5GcmVxdWVuY3kgfHwgMCwgNCwgNSk7XHJcbiAgICBjb25zdCBhU3RyOiBzdHJpbmcgPSBgJHthTWl9ICR7YU5hbWV9ICR7YUZyZXF1ZW5jeX1gO1xyXG4gICAgY29uc3QgYlN0cjogc3RyaW5nID0gYCR7Yk1pfSAke2JOYW1lfSAke2JGcmVxdWVuY3l9YDtcclxuICAgIHJldHVybiBhU3RyID4gYlN0ciA/IDEgOiBhU3RyIDwgYlN0ciA/IC0xIDogMDtcclxuICB9KTtcclxuICAvLyByZXN1bHQuc29ydCgoYSwgYikgPT4geyhhLkNhbGwgPiBiLkNhbGwgPyAxIDogYS5DYWxsIDwgYi5DYWxsID8gLTEgOiAwKSk7XHJcbiAgLy8gcmVzdWx0LnNvcnQoKGEsIGIpID0+IChhLkZyZXF1ZW5jeSAtIGIuRnJlcXVlbmN5KSk7XHJcbiAgLy8gcmVzdWx0LnNvcnQoKGEsIGIpID0+IChhLk1pIC0gYi5NaSkpO1xyXG5cclxuICAvLyBjb25zb2xlLmxvZyhwbGFjZSwgZGlzdGFuY2UsIHJlc3VsdC5sZW5ndGgpO1xyXG5cclxuICBjb25zdCBwYXJ0czogc3RyaW5nW10gPSBwbGFjZS50b1N0cmluZygpLnNwbGl0KGAsYCk7XHJcbiAgY29uc3Qgc3ViUGxhY2U6IHN0cmluZyA9IGAkeyhwYXJ0c1sxXSB8fCBcIi5cIikudHJpbSgpfS8ke3BhcnRzWzBdLnRyaW0oKX1gO1xyXG5cclxuICBsb2coY2hhbGsueWVsbG93KFwiUmVzdWx0c1wiKSwgcmVzdWx0Lmxlbmd0aCwgc3ViUGxhY2UpO1xyXG5cclxuICBhd2FpdCB3cml0ZVRvSnNvbkFuZENzdihgLi4vZGF0YS9yZXBlYXRlcnMvcmVzdWx0cy8ke3N1YlBsYWNlfWAsIHJlc3VsdCk7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IChhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XHJcbiAgY29uc3QgY291bnR5RmlsZURhdGE6IEJ1ZmZlciA9IGF3YWl0IHJlYWRGaWxlQXN5bmMoXCIuLi9kYXRhL0NvbG9yYWRvX0NvdW50eV9TZWF0cy5jc3ZcIik7XHJcbiAgY29uc3QgY291bnR5RGF0YTogSUNvdW50eVNlYXRbXSA9IGF3YWl0IHBhcnNlQXN5bmMoY291bnR5RmlsZURhdGEsIHsgY29sdW1uczogdHJ1ZSB9KTtcclxuICBjb25zdCBjaXRpZXM6IHN0cmluZ1tdID0gY291bnR5RGF0YS5tYXAoKGM6IElDb3VudHlTZWF0KSA9PiBgJHtjW1wiQ291bnR5IFNlYXRcIl19LCBDT2ApO1xyXG4gIHdoaWxlIChjaXRpZXMubGVuZ3RoKSB7XHJcbiAgICBjb25zdCBuYW1lOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBjaXRpZXMuc2hpZnQoKTtcclxuICAgIGlmIChuYW1lKSB7XHJcbiAgICAgIGF3YWl0IHNhdmUobmFtZSwgMjAwKTtcclxuICAgIH1cclxuICB9XHJcbn0pKCk7XHJcblxyXG4vLyBleHBvcnQgZGVmYXVsdCBzdGFydCgpO1xyXG4iXX0=