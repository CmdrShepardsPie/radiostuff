"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const i_repeater_structured_1 = require("@interfaces/i-repeater-structured");
var FrequencyBand;
(function (FrequencyBand) {
    FrequencyBand[FrequencyBand["$2_m"] = 0] = "$2_m";
    FrequencyBand[FrequencyBand["$1_25_m"] = 1] = "$1_25_m";
    FrequencyBand[FrequencyBand["$70_cm"] = 2] = "$70_cm";
})(FrequencyBand = exports.FrequencyBand || (exports.FrequencyBand = {}));
var Mode;
(function (Mode) {
    Mode[Mode["FM"] = 0] = "FM";
    Mode[Mode["ATV"] = 1] = "ATV";
    Mode[Mode["DMR"] = 2] = "DMR";
    Mode[Mode["P25"] = 3] = "P25";
    Mode[Mode["DStar"] = 4] = "DStar";
    Mode[Mode["YSF"] = 5] = "YSF";
})(Mode = exports.Mode || (exports.Mode = {}));
function filterFrequencies(...bands) {
    return (filter) => (bands.includes(FrequencyBand.$2_m) && filter.Frequency.Output >= 144 && filter.Frequency.Output <= 148) ||
        (bands.includes(FrequencyBand.$1_25_m) && filter.Frequency.Output >= 222 && filter.Frequency.Output <= 225) ||
        (bands.includes(FrequencyBand.$70_cm) && filter.Frequency.Output >= 420 && filter.Frequency.Output <= 450);
}
exports.filterFrequencies = filterFrequencies;
function filterDistance(distance) {
    return (filter) => !filter.Location || filter.Location.Distance < distance;
}
exports.filterDistance = filterDistance;
function filterMode(...modes) {
    return (filter) => filter.Status !== i_repeater_structured_1.RepeaterStatus.OffAir &&
        filter.Use === i_repeater_structured_1.RepeaterUse.Open &&
        ((modes.includes(Mode.FM) && !filter.Digital) ||
            (modes.includes(Mode.ATV) && filter.Digital != null && filter.Digital.ATV != null) ||
            (modes.includes(Mode.DMR) && filter.Digital != null && filter.Digital.DMR != null) ||
            (modes.includes(Mode.P25) && filter.Digital != null && filter.Digital.P25 != null) ||
            (modes.includes(Mode.DStar) && filter.Digital != null && filter.Digital.DStar != null) ||
            (modes.includes(Mode.YSF) &&
                ((filter.Digital != null && filter.Digital.YSF != null) ||
                    (filter.VOIP != null && filter.VOIP.Wires != null))));
}
exports.filterMode = filterMode;
function buildName(repeater) {
    let Name = "";
    if (repeater.Callsign) {
        Name += repeater.Callsign.trim();
    }
    else if (repeater.Location && repeater.Location.Local) {
        Name += repeater.Location.Local.trim();
    }
    else if (repeater.Frequency && repeater.Frequency.Output) {
        Name += repeater.Frequency.Output.toString().trim();
    }
    Name = Name.trim().substr(0, 6).trim();
    Name += " ";
    if (!repeater.Digital && repeater.Location) {
        Name += "F";
    }
    if (repeater.Digital && repeater.Digital.YSF) {
        Name += "Y";
    }
    if (repeater.Digital && repeater.Digital.ATV) {
        Name += "T";
    }
    if (repeater.Digital && repeater.Digital.DMR) {
        Name += "M";
    }
    if (repeater.Digital && repeater.Digital.DStar) {
        Name += "S";
    }
    if (repeater.Digital && repeater.Digital.P25) {
        Name += "P";
    }
    if (repeater.VOIP && repeater.VOIP.Wires) {
        Name += "W";
    }
    if (repeater.VOIP && repeater.VOIP.AllStar) {
        Name += "L";
    }
    if (repeater.VOIP && repeater.VOIP.EchoLink) {
        Name += "E";
    }
    if (repeater.VOIP && repeater.VOIP.IRLP) {
        Name += "I";
    }
    Name += " ";
    Name = Name.replace(/[^0-9.a-zA-Z \/]/g, " ").trim();
    Name = Name.replace(/,/g, " ").replace(/\s+/g, " ").trim();
    Name = Name.substr(0, 16).trim();
    return Name;
}
exports.buildName = buildName;
function buildComment(repeater) {
    let Comment = `${repeater.StateID} ${repeater.ID} ${repeater.Location && (repeater.Location.Distance != null) && repeater.Location.Distance.toFixed(2)} ${repeater.Location && repeater.Location.State} ${repeater.Location && repeater.Location.County} ${repeater.Location && repeater.Location.Local} ${repeater.Callsign}`;
    Comment = Comment.replace(/undefined/g, " ").replace(/,/g, " ").replace(/\s+/g, " ").trim();
    return Comment;
}
exports.buildComment = buildComment;
function buildDCS(code) {
    const DCSa = (code || 23).toString().split("");
    const DCS = ["0", "0", "0"];
    DCS.splice(DCS.length - DCSa.length, DCSa.length, ...DCSa);
    return DCS.join("");
}
exports.buildDCS = buildDCS;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmFkaW8taGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL3JhZGlvLWhlbHBlcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw2RUFBcUc7QUFFckcsSUFBWSxhQUlYO0FBSkQsV0FBWSxhQUFhO0lBQ3ZCLGlEQUFJLENBQUE7SUFDSix1REFBTyxDQUFBO0lBQ1AscURBQU0sQ0FBQTtBQUNSLENBQUMsRUFKVyxhQUFhLEdBQWIscUJBQWEsS0FBYixxQkFBYSxRQUl4QjtBQUVELElBQVksSUFPWDtBQVBELFdBQVksSUFBSTtJQUNkLDJCQUFFLENBQUE7SUFDRiw2QkFBRyxDQUFBO0lBQ0gsNkJBQUcsQ0FBQTtJQUNILDZCQUFHLENBQUE7SUFDSCxpQ0FBSyxDQUFBO0lBQ0wsNkJBQUcsQ0FBQTtBQUNMLENBQUMsRUFQVyxJQUFJLEdBQUosWUFBSSxLQUFKLFlBQUksUUFPZjtBQUVELFNBQWdCLGlCQUFpQixDQUFDLEdBQUcsS0FBc0I7SUFDekQsT0FBTyxDQUFDLE1BQTJCLEVBQVcsRUFBRSxDQUM5QyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxJQUFJLEdBQUcsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sSUFBSSxHQUFHLENBQUM7UUFDeEcsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sSUFBSSxHQUFHLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLElBQUksR0FBRyxDQUFDO1FBQzNHLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLElBQUksR0FBRyxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxJ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SSxJQUFJLEVBQUUsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUN6RCxNQUFNLEdBQUcsR0FBYSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDdEMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDO0lBQzNELE9BQU8sR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUN0QixDQUFDO0FBTEQsNEJBS0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJUmVwZWF0ZXJTdHJ1Y3R1cmVkLCBSZXBlYXRlclN0YXR1cywgUmVwZWF0ZXJVc2UgfSBmcm9tIFwiQGludGVyZmFjZXMvaS1yZXBlYXRlci1zdHJ1Y3R1cmVkXCI7XHJcblxyXG5leHBvcnQgZW51bSBGcmVxdWVuY3lCYW5kIHtcclxuICAkMl9tLFxyXG4gICQxXzI1X20sXHJcbiAgJDcwX2NtLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBNb2RlIHtcclxuICBGTSxcclxuICBBVFYsXHJcbiAgRE1SLFxyXG4gIFAyNSxcclxuICBEU3RhcixcclxuICBZU0YsXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJGcmVxdWVuY2llcyguLi5iYW5kczogRnJlcXVlbmN5QmFuZFtdKTogKGZpbHRlcjogSVJlcGVhdGVyU3RydWN0dXJlZCkgPT4gYm9vbGVhbiB7XHJcbiAgcmV0dXJuIChmaWx0ZXI6IElSZXBlYXRlclN0cnVjdHVyZWQpOiBib29sZWFuID0+XHJcbiAgICAoYmFuZHMuaW5jbHVkZXMoRnJlcXVlbmN5QmFuZC4kMl9tKSAmJiBmaWx0ZXIuRnJlcXVlbmN5Lk91dHB1dCA+PSAxNDQgJiYgZmlsdGVyLkZyZXF1ZW5jeS5PdXRwdXQgPD0gMTQ4KSB8fFxyXG4gICAgKGJhbmRzLmluY2x1ZGVzKEZyZXF1ZW5jeUJhbmQuJDFfMjVfbSkgJiYgZmlsdGVyLkZyZXF1ZW5jeS5PdXRwdXQgPj0gMjIyICYmIGZpbHRlci5GcmVxdWVuY3kuT3V0cHV0IDw9IDIyNSkgfHxcclxuICAgIChiYW5kcy5pbmNsdWRlcyhGcmVxdWVuY3lCYW5kLiQ3MF9jbSkgJiYgZmlsdGVyLkZyZXF1ZW5jeS5PdXRwdXQgPj0gNDIwICYmIGZpbHRlci5GcmVxdWVuY3kuT3V0cHV0IDw9IDQ1MCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJEaXN0YW5jZShkaXN0YW5jZTogbnVtYmVyKTogKGZpbHRlcjogSVJlcGVhdGVyU3RydWN0dXJlZCkgPT4gYm9vbGVhbiB7XHJcbiAgcmV0dXJuIChmaWx0ZXI6IElSZXBlYXRlclN0cnVjdHVyZWQpOiBib29sZWFuID0+ICFmaWx0ZXIuTG9jYXRpb24gfHwgZmlsdGVyLkxvY2F0aW9uLkRpc3RhbmNlISA8IGRpc3RhbmNlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyTW9kZSguLi5tb2RlczogTW9kZVtdKTogKGZpbHRlcjogSVJlcGVhdGVyU3RydWN0dXJlZCkgPT4gYm9vbGVhbiB7XHJcbiAgcmV0dXJuIChmaWx0ZXI6IElSZXBlYXRlclN0cnVjdHVyZWQpOiBib29sZWFuID0+XHJcbiAgICBmaWx0ZXIuU3RhdHVzICE9PSBSZXBlYXRlclN0YXR1cy5PZmZBaXIgJiZcclxuICAgIGZpbHRlci5Vc2UgPT09IFJlcGVhdGVyVXNlLk9wZW4gJiZcclxuICAgIChcclxuICAgICAgKG1vZGVzLmluY2x1ZGVzKE1vZGUuRk0pICYmICFmaWx0ZXIuRGlnaXRhbCkgfHxcclxuICAgICAgKG1vZGVzLmluY2x1ZGVzKE1vZGUuQVRWKSAmJiBmaWx0ZXIuRGlnaXRhbCAhPSBudWxsICYmIGZpbHRlci5EaWdpdGFsLkFUViAhPSBudWxsKSB8fFxyXG4gICAgICAobW9kZXMuaW5jbHVkZXMoTW9kZS5ETVIpICYmIGZpbHRlci5EaWdpdGFsICE9IG51bGwgJiYgZmlsdGVyLkRpZ2l0YWwuRE1SICE9IG51bGwpIHx8XHJcbiAgICAgIChtb2Rlcy5pbmNsdWRlcyhNb2RlLlAyNSkgJiYgZmlsdGVyLkRpZ2l0YWwgIT0gbnVsbCAmJiBmaWx0ZXIuRGlnaXRhbC5QMjUgIT0gbnVsbCkgfHxcclxuICAgICAgKG1vZGVzLmluY2x1ZGVzKE1vZGUuRFN0YXIpICYmIGZpbHRlci5EaWdpdGFsICE9IG51bGwgJiYgZmlsdGVyLkRpZ2l0YWwuRFN0YXIgIT0gbnVsbCkgfHxcclxuICAgICAgKFxyXG4gICAgICAgIG1vZGVzLmluY2x1ZGVzKE1vZGUuWVNGKSAmJlxyXG4gICAgICAgIChcclxuICAgICAgICAgIChmaWx0ZXIuRGlnaXRhbCAhPSBudWxsICYmIGZpbHRlci5EaWdpdGFsLllTRiAhPSBudWxsKSB8fFxyXG4gICAgICAgICAgKGZpbHRlci5WT0lQICE9IG51bGwgJiYgZmlsdGVyLlZPSVAuV2lyZXMgIT0gbnVsbClcclxuICAgICAgICApXHJcbiAgICAgIClcclxuICAgICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBidWlsZE5hbWUocmVwZWF0ZXI6IElSZXBlYXRlclN0cnVjdHVyZWQpOiBzdHJpbmcge1xyXG4gIGxldCBOYW1lOiBzdHJpbmcgPSBcIlwiO1xyXG5cclxuICBpZiAocmVwZWF0ZXIuQ2FsbHNpZ24pIHtcclxuICAgIE5hbWUgKz0gcmVwZWF0ZXIuQ2FsbHNpZ24udHJpbSgpO1xyXG4gIH0gZWxzZSBpZiAocmVwZWF0ZXIuTG9jYXRpb24gJiYgcmVwZWF0ZXIuTG9jYXRpb24uTG9jYWwpIHtcclxuICAgIE5hbWUgKz0gcmVwZWF0ZXIuTG9jYXRpb24uTG9jYWwudHJpbSgpO1xyXG4gIH0gZWxzZSBpZiAocmVwZWF0ZXIuRnJlcXVlbmN5ICYmIHJlcGVhdGVyLkZyZXF1ZW5jeS5PdXRwdXQpIHtcclxuICAgIE5hbWUgKz0gcmVwZWF0ZXIuRnJlcXVlbmN5Lk91dHB1dC50b1N0cmluZygpLnRyaW0oKTtcclxuICB9XHJcblxyXG4gIE5hbWUgPSBOYW1lLnRyaW0oKS5zdWJzdHIoMCwgNikudHJpbSgpO1xyXG5cclxuICBOYW1lICs9IFwiIFwiO1xyXG4gIGlmICghcmVwZWF0ZXIuRGlnaXRhbCAmJiByZXBlYXRlci5Mb2NhdGlvbikge1xyXG4gICAgTmFtZSArPSBcIkZcIjtcclxuICB9XHJcbiAgaWYgKHJlcGVhdGVyLkRpZ2l0YWwgJiYgcmVwZWF0ZXIuRGlnaXRhbC5ZU0YpIHtcclxuICAgIE5hbWUgKz0gXCJZXCI7XHJcbiAgfVxyXG4gIGlmIChyZXBlYXRlci5EaWdpdGFsICYmIHJlcGVhdGVyLkRpZ2l0YWwuQVRWKSB7XHJcbiAgICBOYW1lICs9IFwiVFwiO1xyXG4gIH1cclxuICBpZiAocmVwZWF0ZXIuRGlnaXRhbCAmJiByZXBlYXRlci5EaWdpdGFsLkRNUikge1xyXG4gICAgTmFtZSArPSBcIk1cIjtcclxuICB9XHJcbiAgaWYgKHJlcGVhdGVyLkRpZ2l0YWwgJiYgcmVwZWF0ZXIuRGlnaXRhbC5EU3Rhcikge1xyXG4gICAgTmFtZSArPSBcIlNcIjtcclxuICB9XHJcbiAgaWYgKHJlcGVhdGVyLkRpZ2l0YWwgJiYgcmVwZWF0ZXIuRGlnaXRhbC5QMjUpIHtcclxuICAgIE5hbWUgKz0gXCJQXCI7XHJcbiAgfVxyXG4gIGlmIChyZXBlYXRlci5WT0lQICYmIHJlcGVhdGVyLlZPSVAuV2lyZXMpIHtcclxuICAgIE5hbWUgKz0gXCJXXCI7XHJcbiAgfVxyXG4gIGlmIChyZXBlYXRlci5WT0lQICYmIHJlcGVhdGVyLlZPSVAuQWxsU3Rhcikge1xyXG4gICAgTmFtZSArPSBcIkxcIjtcclxuICB9XHJcbiAgaWYgKHJlcGVhdGVyLlZPSVAgJiYgcmVwZWF0ZXIuVk9JUC5FY2hvTGluaykge1xyXG4gICAgTmFtZSArPSBcIkVcIjtcclxuICB9XHJcbiAgaWYgKHJlcGVhdGVyLlZPSVAgJiYgcmVwZWF0ZXIuVk9JUC5JUkxQKSB7XHJcbiAgICBOYW1lICs9IFwiSVwiO1xyXG4gIH1cclxuICBOYW1lICs9IFwiIFwiO1xyXG5cclxuICBOYW1lID0gTmFtZS5yZXBsYWNlKC9bXjAtOS5hLXpBLVogXFwvXS9nLCBcIiBcIikudHJpbSgpO1xyXG4gIE5hbWUgPSBOYW1lLnJlcGxhY2UoLywvZywgXCIgXCIpLnJlcGxhY2UoL1xccysvZywgXCIgXCIpLnRyaW0oKTtcclxuICBOYW1lID0gTmFtZS5zdWJzdHIoMCwgMTYpLnRyaW0oKTtcclxuXHJcbiAgcmV0dXJuIE5hbWU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBidWlsZENvbW1lbnQocmVwZWF0ZXI6IElSZXBlYXRlclN0cnVjdHVyZWQpOiBzdHJpbmcge1xyXG4gIGxldCBDb21tZW50OiBzdHJpbmcgPSBgJHtyZXBlYXRlci5TdGF0ZUlEfSAke3JlcGVhdGVyLklEfSAke3JlcGVhdGVyLkxvY2F0aW9uICYmIChyZXBlYXRlci5Mb2NhdGlvbi5EaXN0YW5jZSAhPSBudWxsKSAmJiByZXBlYXRlci5Mb2NhdGlvbi5EaXN0YW5jZS50b0ZpeGVkKDIpfSAke3JlcGVhdGVyLkxvY2F0aW9uICYmIHJlcGVhdGVyLkxvY2F0aW9uLlN0YXRlfSAke3JlcGVhdGVyLkxvY2F0aW9uICYmIHJlcGVhdGVyLkxvY2F0aW9uLkNvdW50eX0gJHtyZXBlYXRlci5Mb2NhdGlvbiAmJiByZXBlYXRlci5Mb2NhdGlvbi5Mb2NhbH0gJHtyZXBlYXRlci5DYWxsc2lnbn1gO1xyXG4gIENvbW1lbnQgPSBDb21tZW50LnJlcGxhY2UoL3VuZGVmaW5lZC9nLCBcIiBcIikucmVwbGFjZSgvLC9nLCBcIiBcIikucmVwbGFjZSgvXFxzKy9nLCBcIiBcIikudHJpbSgpO1xyXG4gIHJldHVybiBDb21tZW50O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGREQ1MoY29kZTogbnVtYmVyIHwgdW5kZWZpbmVkKTogc3RyaW5nIHtcclxuICBjb25zdCBEQ1NhOiBzdHJpbmdbXSA9IChjb2RlIHx8IDIzKS50b1N0cmluZygpLnNwbGl0KFwiXCIpO1xyXG4gIGNvbnN0IERDUzogc3RyaW5nW10gPSBbXCIwXCIsIFwiMFwiLCBcIjBcIl07XHJcbiAgRENTLnNwbGljZShEQ1MubGVuZ3RoIC0gRENTYS5sZW5ndGgsIERDU2EubGVuZ3RoLCAuLi5EQ1NhKTtcclxuICByZXR1cm4gRENTLmpvaW4oXCJcIik7XHJcbn1cclxuIl19