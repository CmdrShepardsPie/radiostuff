"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const chalk_1 = __importDefault(require("chalk"));
let lastMessageInline = false;
let lastContext;
const bgColors = [
    // "bgBlack",
    "bgRed",
    "bgGreen",
    "bgYellow",
    "bgBlue",
    "bgMagenta",
    "bgCyan",
];
let lastColor = 0;
function createOut(context, color) {
    if (!color) {
        color = bgColors[lastColor];
        lastColor += 1;
        if (lastColor >= bgColors.length) {
            lastColor = 0;
        }
    }
    return { log: createLog(context, color), write: createWrite(context, color) };
}
exports.createOut = createOut;
function createLog(context, color) {
    if (!color) {
        color = bgColors[lastColor];
        lastColor += 1;
        if (lastColor >= bgColors.length) {
            lastColor = 0;
        }
    }
    // @ts-ignore
    const chalkColorFn = chalk_1.default[color];
    return (...msg) => {
        msg = msg.map(prepIfJson);
        // if (lastContext !== context) {
        //   createEmptyLine();
        // }
        if (lastMessageInline) {
            createEmptyLine();
        }
        const args = [chalkColorFn(`${context}:`), ...msg];
        console.log(...args);
        lastMessageInline = false;
        lastContext = context;
    };
}
exports.createLog = createLog;
function createWrite(context, color) {
    if (!color) {
        color = bgColors[lastColor];
        lastColor += 1;
        if (lastColor >= bgColors.length) {
            lastColor = 0;
        }
    }
    // @ts-ignore
    const chalkColorFn = chalk_1.default[color];
    return (...msg) => {
        if (!lastMessageInline) {
            process.stdout.write(chalkColorFn(`${context}:`) + " ");
        }
        if (lastMessageInline && lastContext !== context) {
            createEmptyLine();
            process.stdout.write(chalkColorFn(`${context}:`) + " ");
        }
        process.stdout.write(msg.join(" "));
        lastMessageInline = true;
        lastContext = context;
    };
}
exports.createWrite = createWrite;
function createThrowError(context) {
    const color = bgColors[lastColor];
    lastColor += 1;
    if (lastColor >= bgColors.length) {
        lastColor = 0;
    }
    // @ts-ignore
    const chalkColorFn = chalk_1.default[color];
    return (type, ...msg) => {
        console.log(chalkColorFn(`${context}:`), chalk_1.default.red(`${type} Error:`), ...msg);
        process.exit(1);
    };
}
exports.createThrowError = createThrowError;
function prepIfJson(t) {
    if (t instanceof Error) {
        return t;
    }
    if (typeof t === "string") {
        try {
            t = JSON.parse(t);
        }
        catch (e) {
            /* no empty */
        }
    }
    if (typeof t === "object") {
        try {
            t = JSON.stringify(t, null, 4);
            t = colorizeJsonString(t);
        }
        catch (e) {
            /* no empty */
        }
    }
    return t;
}
function colorizeJsonString(json) {
    // Strings
    json = json.replace(/(\s+)("[^"]*")(,?[\r\n])/gi, `$1${chalk_1.default.yellow("$2")}$3`);
    // booleans, numbers, etc.
    json = json.replace(/(\s+)([^"[{\]}][^[\]{}"\n\r,]*)(,?[\r\n])/gi, `$1${chalk_1.default.cyan("$2")}$3`);
    // Keys
    json = json.replace(/("[^"]*"):/gi, `${chalk_1.default.magenta("$1")}:`);
    return json;
}
function createEmptyLine() {
    console.log();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nLWhlbHBlcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaGVscGVycy9sb2ctaGVscGVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLGtEQUFxQztBQUVyQyxJQUFJLGlCQUFpQixHQUFZLEtBQUssQ0FBQztBQUN2QyxJQUFJLFdBQW1CLENBQUM7QUFFeEIsTUFBTSxRQUFRLEdBQW9CO0lBQ2hDLGFBQWE7SUFDYixPQUFPO0lBQ1AsU0FBUztJQUNULFVBQVU7SUFDVixRQUFRO0lBQ1IsV0FBVztJQUNYLFFBQVE7Q0FVVCxDQUFDO0FBQ0YsSUFBSSxTQUFTLEdBQVcsQ0FBQyxDQUFDO0FBRTFCLFNBQWdCLFNBQVMsQ0FBQyxPQUFlLEVBQUUsS0FBbUI7SUFDNUQsSUFBSSxDQUFDLEtBQUssRUFBRTtRQUNWLEtBQUssR0FBRyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDNUIsU0FBUyxJQUFJLENBQUMsQ0FBQztRQUNmLElBQUksU0FBUyxJQUFJLFFBQVEsQ0FBQyxNQUFNLEVBQUU7WUFDaEMsU0FBUyxHQUFHLENBQUMsQ0FBQztTQUNmO0tBQ0Y7SUFDRCxPQUFPLEVBQUUsR0FBRyxFQUFFLFNBQVMsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLEVBQUUsS0FBSyxFQUFFLFdBQVcsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQztBQUNoRixDQUFDO0FBVEQsOEJBU0M7QUFFRCxTQUFnQixTQUFTLENBQUMsT0FBZSxFQUFFLEtBQW1CO0lBQzVELElBQUksQ0FBQyxLQUFLLEVBQUU7UUFDVixLQUFLLEdBQUcsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzVCLFNBQVMsSUFBSSxDQUFDLENBQUM7UUFDZixJQUFJLFNBQVMsSUFBSSxRQUFRLENBQUMsTUFBTSxFQUFFO1lBQ2hDLFNBQVMsR0FBRyxDQUFDLENBQUM7U0FDZjtLQUNGO0lBQ0QsYUFBYTtJQUNiLE1BQU0sWUFBWSxHQUFVLGVBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUV6QyxPQUFPLENBQUMsR0FBRyxHQUFVLEVBQVEsRUFBRTtRQUM3QixHQUFHLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUUxQixpQ0FBaUM7UUFDakMsdUJBQXVCO1FBQ3ZCLElBQUk7UUFDSixJQUFJLGlCQUFpQixFQUFFO1lBQ3JCLGVBQWUsRUFBRSxDQUFDO1NBQ25CO1FBRUQsTUFBTSxJQUFJLEdBQVUsQ0FBQyxZQUFZLENBQUMsR0FBRyxPQUFPLEdBQUcsQ0FBQyxFQUFFLEdBQUcsR0FBRyxDQUFDLENBQUM7UUFFMUQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDO1FBQ3JCLGlCQUFpQixHQUFHLEtBQUssQ0FBQztRQUMxQixXQUFXLEdBQUcsT0FBTyxDQUFDO0lBQ3hCLENBQUMsQ0FBQztBQUNKLENBQUM7QUEzQkQsOEJBMkJDO0FBRUQsU0FBZ0IsV0FBVyxDQUFDLE9BQWUsRUFBRSxLQUFtQjtJQUM5RCxJQUFJLENBQUMsS0FBSyxFQUFFO1FBQ1YsS0FBSyxHQUFHLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUM1QixTQUFTLElBQUksQ0FBQyxDQUFDO1FBQ2YsSUFBSSxTQUFTLElBQUksUUFBUSxDQUFDLE1BQU0sRUFBRTtZQUNoQyxTQUFTLEdBQUcsQ0FBQyxDQUFDO1NBQ2Y7S0FDRjtJQUNELGFBQWE7SUFDYixNQUFNLFlBQVksR0FBVSxlQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7SUFFekMsT0FBTyxDQUFDLEdBQUcsR0FBVSxFQUFRLEVBQUU7UUFDN0IsSUFBSSxDQUFDLGlCQUFpQixFQUFFO1lBQ3RCLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxHQUFHLE9BQU8sR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUM7U0FDekQ7UUFDRCxJQUFJLGlCQUFpQixJQUFJLFdBQVcsS0FBSyxPQUFPLEVBQUU7WUFDaEQsZUFBZSxFQUFFLENBQUM7WUFDbEIsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLEdBQUcsT0FBTyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztTQUN6RDtRQUNELE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNwQyxpQkFBaUIsR0FBRyxJQUFJLENBQUM7UUFDekIsV0FBVyxHQUFHLE9BQU8sQ0FBQztJQUN4QixDQUFDLENBQUM7QUFDSixDQUFDO0FBdkJELGtDQXVCQztBQUVELFNBQWdCLGdCQUFnQixDQUFDLE9BQWU7SUFDOUMsTUFBTSxLQUFLLEdBQWdCLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUMvQyxTQUFTLElBQUksQ0FBQyxDQUFDO0lBQ2YsSUFBSSxTQUFTLElBQUksUUFBUSxDQUFDLE1BQU0sRUFBRTtRQUNoQyxTQUFTLEdBQUcsQ0FBQyxDQUFDO0tBQ2Y7SUFDRCxhQUFhO0lBQ2IsTUFBTSxZQUFZLEdBQVUsZUFBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBRXpDLE9BQU8sQ0FBQyxJQUFZLEVBQUUsR0FBRyxHQUFVLEVBQVEsRUFBRTtRQUMzQyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxHQUFHLE9BQU8sR0FBRyxDQUFDLEVBQUUsZUFBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksU0FBUyxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUMsQ0FBQztRQUM5RSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2xCLENBQUMsQ0FBQztBQUNKLENBQUM7QUFiRCw0Q0FhQztBQUVELFNBQVMsVUFBVSxDQUFDLENBQU07SUFDeEIsSUFBSSxDQUFDLFlBQVksS0FBSyxFQUFFO1FBQ3RCLE9BQU8sQ0FBQyxDQUFDO0tBQ1Y7SUFDRCxJQUFJLE9BQU8sQ0FBQyxLQUFLLFFBQVEsRUFBRTtRQUN6QixJQUFJO1lBQ0YsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDbkI7UUFBQyxPQUFPLENBQUMsRUFBRTtZQUNWLGNBQWM7U0FDZjtLQUNGO0lBQ0QsSUFBSSxPQUFPLENBQUMsS0FBSyxRQUFRLEVBQUU7UUFDekIsSUFBSTtZQUNGLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDL0IsQ0FBQyxHQUFHLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQzNCO1FBQUMsT0FBTyxDQUFDLEVBQUU7WUFDVixjQUFjO1NBQ2Y7S0FDRjtJQUNELE9BQU8sQ0FBQyxDQUFDO0FBQ1gsQ0FBQztBQUVELFNBQVMsa0JBQWtCLENBQUMsSUFBWTtJQUN0QyxVQUFVO0lBQ1YsSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQ2pCLDRCQUE0QixFQUM1QixLQUFLLGVBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FDNUIsQ0FBQztJQUNGLDBCQUEwQjtJQUMxQixJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FDakIsNkNBQTZDLEVBQzdDLEtBQUssZUFBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUMxQixDQUFDO0lBQ0YsT0FBTztJQUNQLElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLGNBQWMsRUFBRSxHQUFHLGVBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQy9ELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQUVELFNBQVMsZUFBZTtJQUN0QixPQUFPLENBQUMsR0FBRyxFQUFFLENBQUM7QUFDaEIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjaGFsaywgeyBDaGFsayB9IGZyb20gXCJjaGFsa1wiO1xyXG5cclxubGV0IGxhc3RNZXNzYWdlSW5saW5lOiBib29sZWFuID0gZmFsc2U7XHJcbmxldCBsYXN0Q29udGV4dDogc3RyaW5nO1xyXG5cclxuY29uc3QgYmdDb2xvcnM6IChrZXlvZiBDaGFsaylbXSA9IFtcclxuICAvLyBcImJnQmxhY2tcIixcclxuICBcImJnUmVkXCIsXHJcbiAgXCJiZ0dyZWVuXCIsXHJcbiAgXCJiZ1llbGxvd1wiLFxyXG4gIFwiYmdCbHVlXCIsXHJcbiAgXCJiZ01hZ2VudGFcIixcclxuICBcImJnQ3lhblwiLFxyXG4gIC8vIFwiYmdXaGl0ZVwiLFxyXG4gIC8vIFwiYmdCbGFja0JyaWdodFwiLFxyXG4gIC8vIFwiYmdSZWRCcmlnaHRcIixcclxuICAvLyBcImJnR3JlZW5CcmlnaHRcIixcclxuICAvLyBcImJnWWVsbG93QnJpZ2h0XCIsXHJcbiAgLy8gXCJiZ0JsdWVCcmlnaHRcIixcclxuICAvLyBcImJnTWFnZW50YUJyaWdodFwiLFxyXG4gIC8vIFwiYmdDeWFuQnJpZ2h0XCIsXHJcbiAgLy8gXCJiZ1doaXRlQnJpZ2h0XCIsXHJcbl07XHJcbmxldCBsYXN0Q29sb3I6IG51bWJlciA9IDA7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlT3V0KGNvbnRleHQ6IHN0cmluZywgY29sb3I/OiBrZXlvZiBDaGFsayk6IHsgbG9nOiAoLi4ubXNnOiBhbnlbXSkgPT4gdm9pZDsgd3JpdGU6ICguLi5tc2c6IGFueVtdKSA9PiB2b2lkIH0ge1xyXG4gIGlmICghY29sb3IpIHtcclxuICAgIGNvbG9yID0gYmdDb2xvcnNbbGFzdENvbG9yXTtcclxuICAgIGxhc3RDb2xvciArPSAxO1xyXG4gICAgaWYgKGxhc3RDb2xvciA+PSBiZ0NvbG9ycy5sZW5ndGgpIHtcclxuICAgICAgbGFzdENvbG9yID0gMDtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHsgbG9nOiBjcmVhdGVMb2coY29udGV4dCwgY29sb3IpLCB3cml0ZTogY3JlYXRlV3JpdGUoY29udGV4dCwgY29sb3IpIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMb2coY29udGV4dDogc3RyaW5nLCBjb2xvcj86IGtleW9mIENoYWxrKTogKC4uLm1zZzogYW55W10pID0+IHZvaWQge1xyXG4gIGlmICghY29sb3IpIHtcclxuICAgIGNvbG9yID0gYmdDb2xvcnNbbGFzdENvbG9yXTtcclxuICAgIGxhc3RDb2xvciArPSAxO1xyXG4gICAgaWYgKGxhc3RDb2xvciA+PSBiZ0NvbG9ycy5sZW5ndGgpIHtcclxuICAgICAgbGFzdENvbG9yID0gMDtcclxuICAgIH1cclxuICB9XHJcbiAgLy8gQHRzLWlnbm9yZVxyXG4gIGNvbnN0IGNoYWxrQ29sb3JGbjogQ2hhbGsgPSBjaGFsa1tjb2xvcl07XHJcblxyXG4gIHJldHVybiAoLi4ubXNnOiBhbnlbXSk6IHZvaWQgPT4ge1xyXG4gICAgbXNnID0gbXNnLm1hcChwcmVwSWZKc29uKTtcclxuXHJcbiAgICAvLyBpZiAobGFzdENvbnRleHQgIT09IGNvbnRleHQpIHtcclxuICAgIC8vICAgY3JlYXRlRW1wdHlMaW5lKCk7XHJcbiAgICAvLyB9XHJcbiAgICBpZiAobGFzdE1lc3NhZ2VJbmxpbmUpIHtcclxuICAgICAgY3JlYXRlRW1wdHlMaW5lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXJnczogYW55W10gPSBbY2hhbGtDb2xvckZuKGAke2NvbnRleHR9OmApLCAuLi5tc2ddO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKC4uLmFyZ3MpO1xyXG4gICAgbGFzdE1lc3NhZ2VJbmxpbmUgPSBmYWxzZTtcclxuICAgIGxhc3RDb250ZXh0ID0gY29udGV4dDtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlV3JpdGUoY29udGV4dDogc3RyaW5nLCBjb2xvcj86IGtleW9mIENoYWxrKTogKC4uLm1zZzogYW55W10pID0+IHZvaWQge1xyXG4gIGlmICghY29sb3IpIHtcclxuICAgIGNvbG9yID0gYmdDb2xvcnNbbGFzdENvbG9yXTtcclxuICAgIGxhc3RDb2xvciArPSAxO1xyXG4gICAgaWYgKGxhc3RDb2xvciA+PSBiZ0NvbG9ycy5sZW5ndGgpIHtcclxuICAgICAgbGFzdENvbG9yID0gMDtcclxuICAgIH1cclxuICB9XHJcbiAgLy8gQHRzLWlnbm9yZVxyXG4gIGNvbnN0IGNoYWxrQ29sb3JGbjogQ2hhbGsgPSBjaGFsa1tjb2xvcl07XHJcblxyXG4gIHJldHVybiAoLi4ubXNnOiBhbnlbXSk6IHZvaWQgPT4ge1xyXG4gICAgaWYgKCFsYXN0TWVzc2FnZUlubGluZSkge1xyXG4gICAgICBwcm9jZXNzLnN0ZG91dC53cml0ZShjaGFsa0NvbG9yRm4oYCR7Y29udGV4dH06YCkgKyBcIiBcIik7XHJcbiAgICB9XHJcbiAgICBpZiAobGFzdE1lc3NhZ2VJbmxpbmUgJiYgbGFzdENvbnRleHQgIT09IGNvbnRleHQpIHtcclxuICAgICAgY3JlYXRlRW1wdHlMaW5lKCk7XHJcbiAgICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKGNoYWxrQ29sb3JGbihgJHtjb250ZXh0fTpgKSArIFwiIFwiKTtcclxuICAgIH1cclxuICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKG1zZy5qb2luKFwiIFwiKSk7XHJcbiAgICBsYXN0TWVzc2FnZUlubGluZSA9IHRydWU7XHJcbiAgICBsYXN0Q29udGV4dCA9IGNvbnRleHQ7XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRocm93RXJyb3IoY29udGV4dDogc3RyaW5nKTogKHR5cGU6IHN0cmluZywgLi4ubXNnOiBhbnlbXSkgPT4gdm9pZCB7XHJcbiAgY29uc3QgY29sb3I6IGtleW9mIENoYWxrID0gYmdDb2xvcnNbbGFzdENvbG9yXTtcclxuICBsYXN0Q29sb3IgKz0gMTtcclxuICBpZiAobGFzdENvbG9yID49IGJnQ29sb3JzLmxlbmd0aCkge1xyXG4gICAgbGFzdENvbG9yID0gMDtcclxuICB9XHJcbiAgLy8gQHRzLWlnbm9yZVxyXG4gIGNvbnN0IGNoYWxrQ29sb3JGbjogQ2hhbGsgPSBjaGFsa1tjb2xvcl07XHJcblxyXG4gIHJldHVybiAodHlwZTogc3RyaW5nLCAuLi5tc2c6IGFueVtdKTogdm9pZCA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhjaGFsa0NvbG9yRm4oYCR7Y29udGV4dH06YCksIGNoYWxrLnJlZChgJHt0eXBlfSBFcnJvcjpgKSwgLi4ubXNnKTtcclxuICAgIHByb2Nlc3MuZXhpdCgxKTtcclxuICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBwcmVwSWZKc29uKHQ6IGFueSk6IEVycm9yIHwgc3RyaW5nIHtcclxuICBpZiAodCBpbnN0YW5jZW9mIEVycm9yKSB7XHJcbiAgICByZXR1cm4gdDtcclxuICB9XHJcbiAgaWYgKHR5cGVvZiB0ID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICB0ID0gSlNPTi5wYXJzZSh0KTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgLyogbm8gZW1wdHkgKi9cclxuICAgIH1cclxuICB9XHJcbiAgaWYgKHR5cGVvZiB0ID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICB0ID0gSlNPTi5zdHJpbmdpZnkodCwgbnVsbCwgNCk7XHJcbiAgICAgIHQgPSBjb2xvcml6ZUpzb25TdHJpbmcodCk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIC8qIG5vIGVtcHR5ICovXHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiB0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjb2xvcml6ZUpzb25TdHJpbmcoanNvbjogc3RyaW5nKTogc3RyaW5nIHtcclxuICAvLyBTdHJpbmdzXHJcbiAganNvbiA9IGpzb24ucmVwbGFjZShcclxuICAgIC8oXFxzKykoXCJbXlwiXSpcIikoLD9bXFxyXFxuXSkvZ2ksXHJcbiAgICBgJDEke2NoYWxrLnllbGxvdyhcIiQyXCIpfSQzYCxcclxuICApO1xyXG4gIC8vIGJvb2xlYW5zLCBudW1iZXJzLCBldGMuXHJcbiAganNvbiA9IGpzb24ucmVwbGFjZShcclxuICAgIC8oXFxzKykoW15cIlt7XFxdfV1bXltcXF17fVwiXFxuXFxyLF0qKSgsP1tcXHJcXG5dKS9naSxcclxuICAgIGAkMSR7Y2hhbGsuY3lhbihcIiQyXCIpfSQzYCxcclxuICApO1xyXG4gIC8vIEtleXNcclxuICBqc29uID0ganNvbi5yZXBsYWNlKC8oXCJbXlwiXSpcIik6L2dpLCBgJHtjaGFsay5tYWdlbnRhKFwiJDFcIil9OmApO1xyXG4gIHJldHVybiBqc29uO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVFbXB0eUxpbmUoKTogdm9pZCB7XHJcbiAgY29uc29sZS5sb2coKTtcclxufVxyXG4iXX0=